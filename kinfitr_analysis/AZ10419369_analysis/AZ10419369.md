-   [Aims](#aims)
-   [Libraries](#libraries)
    -   [CRAN libraries](#cran-libraries)
    -   [Non-CRAN libraries](#non-cran-libraries)
        -   [Loading Non\_CRAN libraries and setting
            theme](#loading-non_cran-libraries-and-setting-theme)
    -   [Creating folders using
        “initProjectFolder()”](#creating-folders-using-initprojectfolder)
-   [Extracting kinfitresults](#extracting-kinfitresults)
-   [Tidying data.](#tidying-data.)
-   [New weights with
    kinfitr::weights\_create](#new-weights-with-kinfitrweights_create)
-   [Fitting and plotting MRTM1 multiple times for regions FC and
    WB](#fitting-and-plotting-mrtm1-multiple-times-for-regions-fc-and-wb)
-   [Fitting MRTM2 to each region of each
    individual](#fitting-mrtm2-to-each-region-of-each-individual)
    -   [Plotting fitted MRTM2 model](#plotting-fitted-mrtm2-model)
        -   [Plot MRTM2 tacs](#plot-mrtm2-tacs)
-   [new plot MRTM2](#new-plot-mrtm2)
-   [Fitting kintetic model srtm](#fitting-kintetic-model-srtm)
-   [Plotting Kinetic Model srtm](#plotting-kinetic-model-srtm)
-   [new plot srtm](#new-plot-srtm)
-   [plot logan\_tstar](#plot-logan_tstar)
    -   [All 4 tstar plots on a single
        page](#all-4-tstar-plots-on-a-single-page)
    -   [Plot refLogan](#plot-reflogan)
-   [Test-retest](#test-retest)
    -   [Making the trt\_table](#making-the-trt_table)
-   [Interregional Correlation](#interregional-correlation)
-   [bp corellation](#bp-corellation)
    -   [R-squared](#r-squared)

Aims
====

The aim of this assignment is to analyze the AZ10419369 data in kinfitr

Libraries
=========

CRAN libraries
--------------

First, the libraries for the analysis and plotting are loaded.

``` r
library(tidyverse)
library(stringr)
library(corrplot)
library(grid)
library(gridExtra)
library(RColorBrewer)
library(psych)
library(readxl)
library(pracma)
library(lme4)
library(rjags)
library(knitr)
library(cowplot)
library(corrplot)
library(viridis)
library(kableExtra)
```

Non-CRAN libraries
------------------

The libraries above can be installed from CRAN. Those which cannot are
installed as follows:

``` r
install.packages("devtools")  # If you do not already have devtools
devtools::install_github("mathesong/kinfitr")
devtools::install_github("mathesong/granviller")
devtools::install_github("mvuorre/vmisc")
devtools::install_github("mathesong/kipettools")
devtools::install_github("mathesong/relfeas")
```

### Loading Non\_CRAN libraries and setting theme

``` r
library(kinfitr)
library(vmisc)
library(kipettools)
library(granviller)
library(relfeas)

theme_set(theme_light())
```

Creating folders using “initProjectFolder()”
--------------------------------------------

``` r
initProjectFolder()
```

Extracting kinfitresults
========================

``` r
 tactibble <- tibble(Filename = list.files(path = "../RawData/", 
                                           pattern = "kinfitresults.mat")) %>% 
  group_by(Filename) %>% 
  mutate(tacdata = map(Filename, ~kipettools::kfresults_getData(
    paste0("../RawData/", .x))))

saveRDS(tactibble, '../DerivedData/tactibble.rds')
```

Tidying data.
=============

``` r
#loading data

tacs <- readRDS('../DerivedData/tactibble.rds')

tacs <- tacs %>% 
  ungroup() %>% 
  mutate(Subjname = map_chr(tacdata, "Subjname"),
         PETNo = map_dbl(tacdata, "PETNo"),
         tacdata = map(tacdata, "tacdata")) %>% 
  select(-Filename) 
```

New weights with kinfitr::weights\_create
=========================================

``` r
#Creating start and end times and 
#removing the old weights, so that there is no mix-up later on

tacs <- tacs %>% 
  unnest() %>% 
  mutate("start" = times - (durations/2)) %>% 
  mutate("end" = times + (durations/2)) %>% 
  select(-weights)

# New weights

tacs$weights <- weights_create(t_start = tacs$start, t_end = tacs$end, 
                               tac = tacs$WB, radioisotope = "C11")
#Nest

tacs <- tacs %>%
  nest(-Subjname, -PETNo, .key = 'tacdata')
```

Fitting and plotting MRTM1 multiple times for regions FC and WB
===============================================================

``` r
#K2 prime for striatum to be used to MRTM2 later on

 tacs <- tacs %>% 
  group_by(Subjname, PETNo) %>% 
  mutate(MRTM1fit = map(tacdata, ~mrtm1(t_tac = .x$times, reftac = .x$gmRefCBL,
                                   roitac = .x$gmfslSTR, 
                                      weights = .x$weights))) %>% 
  ungroup() %>% 
  mutate(bp_MRTM1 = map_dbl(MRTM1fit, c("par", "bp")),
         k2prime_MRTM1 = map_dbl(MRTM1fit, c("par", "k2prime"))) %>% 
  group_by(Subjname, PETNo) %>% 
  mutate(logan_tstar = map2(tacdata, k2prime_MRTM1,
                 ~refLogan_tstar(t_tac = .x$times, 
                    reftac = .x$gmRefCBL, lowroi = .x$gmL_fslThalamus, 
                    medroi = .x$gmfslFrontal_Lobe, highroi = .x$gmfslOccipital_Lobe, 
                   k2prime = .y)))
```

Fitting MRTM2 to each region of each individual
===============================================

First, let’s select some specific regions. Note: I duplicated the CBL
region column into “CBL” and “Ref”. One of them is used to make the
reference tissue models when nested in tacdata whereas the other is used
for plotting in the new “all regions per PET +facet wrap by PET” - plot.
However, the srtm fitting gave me an error when I did this

``` r
regions <- c("STR" = "gmfslSTR", "FC" = "gmfslFrontal_Lobe", "WB", "WM", "GM", "OC" = "gmfslOccipital_Lobe", "insula" = "gmfslInsula", "Putamen" = "gmfslPutamen", "Caudate" = "gmfslCaudate", "CBL" = "gmRefCBL", "THA" = "gmfslThalamus", "TC" =
               "gmfslTemporal_Lobe")
 
tacs <- tacs %>% 
  select(tacdata, Subjname, PETNo, k2prime_MRTM1, logan_tstar) %>% 
  mutate(tacdata = map(tacdata, ~select(.x, regions, times, weights))) 


#Long data. By gathering the regions into a single region collumn we can group_by region and then iterate over every region. note, do not select the reference region, as that should be included for every single region and not group_by seperately from the rest!

tacs_long <- tacs %>% 
  unnest(tacdata, .drop = FALSE) %>% 
  gather(key = Region, value = TAC, -times, -weights,
         -Subjname, -PETNo, -k2prime_MRTM1, -CBL, -logan_tstar) %>% 
  group_by(Subjname, PETNo, Region, k2prime_MRTM1) %>% 
  nest(.key = "tacdata") %>% 
  mutate(PET = paste(Subjname, PETNo, sep='_')) 

#Fitting MRTM2 using the K2_prime values obtained for the striatum through the MRTM1 fitting earlier. note Map2 iterates over 2 columns tacdata and k2prime_MRTM1, where .x refers to tacdata and .y refers to k2prime_MRTM1.

tacs_long <- tacs_long %>% 
  group_by(Subjname, PETNo, Region) %>% 
  mutate(MRTM2fit = map2(tacdata, k2prime_MRTM1,
                         ~mrtm2(t_tac=.x$times, reftac = .x$CBL, 
                               roitac = .x$TAC, k2prime = .y, 
                               weights = .x$weights,tstarIncludedFrames = 20)),
         bp_MRTM2 = map_dbl(MRTM2fit, c("par", "bp"))) 
```

Plotting fitted MRTM2 model
---------------------------

And now, let’s take a look at the BP<sub>ND</sub> values. We’ll want to
divide them by ROI I think.

``` r
ggplot(tacs_long, aes(x=bp_MRTM2, fill=Region)) +
  geom_histogram(colour="black") +
  facet_wrap(~Region, scales="free") +
  guides(fill=FALSE)
```

### Plot MRTM2 tacs

Labels for regions are wrong. My intention is to have one plot per
region for each PET in the same grid. Currently, all labels for the
regions are the same for each individual.

``` r
mrtm2_fits = map2(tacs_long$MRTM2fit, tacs_long$Region, 
                    ~plot_kinfit(.x, roiname=.y))
 
PETs <- unique(tacs_long$PET)
 
allFits <- data.frame(PET = rep(PETs, each= 9)) %>%
 mutate(Fit = mrtm2_fits,
          Plot = 'Fit',
          PET = as.character(PET)) %>%
   arrange(PET, Plot)
 
 marrangeGrob(allFits$Fit, nrow=3, ncol=3, top=quote(paste('PET: ', PETs[g])))
```

new plot MRTM2
==============

``` r
MRTM2 <- tacs_long %>% 
  group_by(PET, Region) %>% 
  mutate(mrtm2fits = map(MRTM2fit, c("tacs"))) %>% 
   select(PET, Region, mrtm2fits) %>% 
  filter(Region %in% c('FC', 'WB', 'insula', 'OC')) %>% 
  unnest()
         

ggplot() +
  geom_point(data = MRTM2, aes(x=Time, y=Target, color = Region)) + geom_line(data = MRTM2, aes(x = Time, y=Target, color = Region)) + geom_point(data = MRTM2, aes(x=Time, y=Reference, color = "Ref")) + geom_line(data = MRTM2, aes(x=Time, y=Reference, color = "Ref")) +
  facet_wrap(~ PET , ncol=2)
```

![](AZ10419369_files/figure-markdown_github/new_plot_MRTM2-1.png)

Fitting kintetic model srtm
===========================

``` r
tacs_long <- tacs_long %>% 
  group_by(Subjname, PETNo, Region) %>%
  mutate(srtmfit = map(tacdata, ~srtm(t_tac = .x$times, reftac = .x$CBL,      
                                      roitac = .x$TAC, weights = .x$weights))) %>% 
  mutate(bp_srtm = map_dbl(srtmfit, c('par', 'bp')))
```

    ## Registered S3 methods overwritten by 'car':
    ##   method                          from
    ##   influence.merMod                lme4
    ##   cooks.distance.influence.merMod lme4
    ##   dfbeta.influence.merMod         lme4
    ##   dfbetas.influence.merMod        lme4

Plotting Kinetic Model srtm
===========================

Note: Labels are not quite at the same location for each PET, still
unsolved.

``` r
srtm_plot <-tacs_long %>% 
 group_by(PET, Region) %>% 
  mutate(srtm_graph = map2(srtmfit, Region, 
      ~ plot_kinfit(.x, roiname = .y))) %>% 
  ungroup() %>% 
  filter(Region %in% c('FC', 'WB', 'ACC', 'CBL')) %>% 
  select(PET, srtm_graph) %>%
  group_by(PET) %>% 
  arrange(PET)
  

walk2(list(srtm_plot$srtm_graph), unique(srtm_plot$PET), 
    ~print(plot_grid( plotlist = .x, ncol = 2, nrow = 2, align = 'hv') +
  draw_plot_label( label = .y , y = 1, x = 0.5, fontface = "bold", size = 20, colour = "red", hjust = 1, vjust = 1.2)))
```

![](AZ10419369_files/figure-markdown_github/plot_srtm-1.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-2.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-3.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-4.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-5.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-6.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-7.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-8.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-9.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-10.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-11.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-12.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-13.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-14.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-15.png)![](AZ10419369_files/figure-markdown_github/plot_srtm-16.png)

new plot srtm
=============

``` r
Srtm <- tacs_long %>% 
  group_by(PET, Region) %>% 
  mutate(srtmtacs = map(srtmfit, c("tacs"))) %>% 
   select(PET, Region, srtmtacs) %>% 
  filter(Region %in% c('FC', 'WB', 'insula', 'OC')) %>% 
  unnest()
         
ggplot() +
  geom_point(data = Srtm, aes(x=Time, y=Target, color = Region)) + geom_line(data = Srtm, aes(x = Time, y=Target_fitted, color = Region)) + geom_point(data = Srtm, aes(x=Time, y=Reference, color = "Ref")) + geom_line(data = Srtm, aes(x=Time, y=Reference, color = "Ref")) +
  facet_wrap(~ PET , ncol=2)
```

plot logan\_tstar
=================

Trouble with label, it is at the same level as the medium, high and low
ROI labels. Tried moving label with vjust = 0.5. It works, sort of. the
label moves up, half of it dissapears and part of the plots at the
bottom dissapear. Solution?? Addition: in the end I did manage to get
the label up a bit without harming the graph, vjust = 0.97 was the
lowest vjust value I could make. I temporarilly changed the color of the
label to distinguish easier. Looks a little unprofessional, though. I
tried with draw\_labels or draw-figure\_labels and didn’t see any
improvement. Also, I tried getting all the subjects into the same pane
by making ncol = 2 and nrow = 3 or making sample\_n(size = 4) and ncol
and nrow = 2. It just got really messy. Also, initially I thought I
could skip “print”, but that is not possible. you get no error without
print, but no graphs either. I thought I got no graph because of eval =
FALSE, but that was an incorrect assumption.

``` r
set.seed(123)

tstar_fits <- tacs_long %>%  
  ungroup() %>% 
  select(tacdata, PET) %>% 
  unnest() %>% 
  select(PET, logan_tstar) %>% 
  sample_n(size =  4, replace = F) 


walk2(list(tstar_fits$logan_tstar), tstar_fits$PET, 
    ~print(plot_grid(plotlist = .x, ncol = 1, nrow = 1, labels = paste('PET:',.y), label_x = 0.5, label_y = 1, label_colour = "blue", vjust = 0.97)))
```

![](AZ10419369_files/figure-markdown_github/plot_tstar-1.png)![](AZ10419369_files/figure-markdown_github/plot_tstar-2.png)![](AZ10419369_files/figure-markdown_github/plot_tstar-3.png)![](AZ10419369_files/figure-markdown_github/plot_tstar-4.png)

All 4 tstar plots on a single page
----------------------------------

Note: I would like to have the “draw\_figure\_label” be drawn a bit
above the first PET, but that does not seem to be happening. Should I
just skip it? I Placed the plots in a single column because it was a
little hard distinguishing where one ands and another begins in a 2 x 2
format. Perhaps one could put borders and then the 2 x 2 would work
better?

``` r
plot_grid(plotlist = tstar_fits$logan_tstar, ncol = 1, nrow = 4, labels = paste('PET:',tstar_fits$PET), label_x = 0.5, label_y = 1, label_colour = "blue", vjust = 0.97) #+
  #draw_figure_label("t*", position = "top", fontface = "bold", size = 32, colour = "red")
```

\#Fitting and plotting Kinetic Model refLogan

Note: no weights are used here!

``` r
tacs_long <- tacs_long %>% 
   group_by(PET, Subjname, PETNo, Region) %>% 
  mutate(loganfit = map2(tacdata, k2prime_MRTM1,
          ~refLogan(t_tac = .x$times , reftac = .x$CBL, roitac = .x$TAC, tstarIncludedFrames = 10, k2prime = .y ))) %>% 
     mutate(bp_refLogan = map_dbl(loganfit, c("par", "bp"))) %>%  
  ungroup()
```

Plot refLogan
-------------

``` r
logan_plot <-tacs_long %>% 
 group_by(PET, Region) %>% 
  mutate(logan_graph = map2(loganfit, Region, 
      ~ plot(.x, roiname = .y))) %>% 
  ungroup() %>% 
  filter(Region %in% c('FC', 'WB', 'STR', 'OC')) %>% 
  select(PET, logan_graph) %>%
  group_by(PET) %>% 
  arrange(PET)
  

walk2(list(logan_plot$logan_graph), unique(logan_plot$PET), 
    ~print(plot_grid( plotlist = .x, ncol = 2, nrow = 2) +
  draw_plot_label( label = .y , y = 1, x = 0.5, fontface = "bold", size = 20, colour = "red", hjust = 1, vjust = 1.2)))
```

![](AZ10419369_files/figure-markdown_github/Plot_refLogan-1.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-2.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-3.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-4.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-5.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-6.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-7.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-8.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-9.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-10.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-11.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-12.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-13.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-14.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-15.png)![](AZ10419369_files/figure-markdown_github/Plot_refLogan-16.png)

Test-retest
===========

``` r
trt_check <- tacs_long %>%
  select(Subjname, PETNo, Region, bp_MRTM2, bp_srtm, bp_refLogan) %>% 
  gather(Measure, Value, -Subjname, -PETNo, -Region) %>% 
  group_by(Region, Measure) %>% 
  nest(.key = "data") 

# saveRDS(tacs_long,'../DerivedData/raw_kinfit_AZ10419369.rds')
```

### Making the trt\_table

``` r
trt_check <- trt_check %>% 
  group_by(Region, Measure) %>% 
  mutate(trt = map(data, ~relfeas::trt(.x, 
                                       values = "Value", 
                                       cases = "Subjname")),
         trt_tidy = map(trt, c("tidy")))

trt_table <- select(trt_check, trt_tidy) %>% 
  unnest()

kable(trt_table, digits=3,format = 'markdown')
```

<table style="width:100%;">
<colgroup>
<col style="width: 7%" />
<col style="width: 10%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 8%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 5%" />
<col style="width: 6%" />
<col style="width: 7%" />
<col style="width: 9%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Region</th>
<th style="text-align: left;">Measure</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">cov</th>
<th style="text-align: right;">skew</th>
<th style="text-align: right;">kurtosis</th>
<th style="text-align: right;">icc</th>
<th style="text-align: right;">icc_l</th>
<th style="text-align: right;">icc_u</th>
<th style="text-align: right;">wscv</th>
<th style="text-align: right;">sdd</th>
<th style="text-align: right;">absvar</th>
<th style="text-align: right;">signvar</th>
<th style="text-align: right;">signvar_sd</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">STR</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.304</td>
<td style="text-align: right;">0.158</td>
<td style="text-align: right;">0.121</td>
<td style="text-align: right;">0.258</td>
<td style="text-align: right;">-1.383</td>
<td style="text-align: right;">0.659</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.918</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.264</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">-0.052</td>
<td style="text-align: right;">0.102</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.453</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">-0.087</td>
<td style="text-align: right;">-0.887</td>
<td style="text-align: right;">0.237</td>
<td style="text-align: right;">-0.485</td>
<td style="text-align: right;">0.777</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">0.324</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">-0.040</td>
<td style="text-align: right;">0.113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WB</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">0.957</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">-0.086</td>
<td style="text-align: right;">-1.014</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">-0.389</td>
<td style="text-align: right;">0.789</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.224</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">-0.053</td>
<td style="text-align: right;">0.118</td>
</tr>
<tr class="even">
<td style="text-align: left;">WM</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">0.164</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">0.802</td>
<td style="text-align: right;">0.034</td>
<td style="text-align: right;">-1.222</td>
<td style="text-align: right;">0.526</td>
<td style="text-align: right;">-0.130</td>
<td style="text-align: right;">0.878</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.257</td>
<td style="text-align: right;">0.509</td>
<td style="text-align: right;">-0.658</td>
<td style="text-align: right;">0.858</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GM</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.122</td>
<td style="text-align: right;">0.096</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">-0.909</td>
<td style="text-align: right;">0.300</td>
<td style="text-align: right;">-0.384</td>
<td style="text-align: right;">0.799</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.226</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">-0.042</td>
<td style="text-align: right;">0.099</td>
</tr>
<tr class="even">
<td style="text-align: left;">OC</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.423</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">-0.476</td>
<td style="text-align: right;">-0.955</td>
<td style="text-align: right;">0.520</td>
<td style="text-align: right;">-0.137</td>
<td style="text-align: right;">0.877</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.231</td>
<td style="text-align: right;">0.047</td>
<td style="text-align: right;">-0.037</td>
<td style="text-align: right;">0.081</td>
</tr>
<tr class="odd">
<td style="text-align: left;">insula</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.416</td>
<td style="text-align: right;">0.123</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">-0.395</td>
<td style="text-align: right;">-1.033</td>
<td style="text-align: right;">0.307</td>
<td style="text-align: right;">-0.304</td>
<td style="text-align: right;">0.793</td>
<td style="text-align: right;">0.075</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">-0.056</td>
<td style="text-align: right;">0.101</td>
</tr>
<tr class="even">
<td style="text-align: left;">Putamen</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.407</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">-0.059</td>
<td style="text-align: right;">-1.245</td>
<td style="text-align: right;">0.504</td>
<td style="text-align: right;">-0.148</td>
<td style="text-align: right;">0.871</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.277</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">-0.050</td>
<td style="text-align: right;">0.100</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caudate</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">0.866</td>
<td style="text-align: right;">0.145</td>
<td style="text-align: right;">0.167</td>
<td style="text-align: right;">0.262</td>
<td style="text-align: right;">-1.429</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">0.021</td>
<td style="text-align: right;">0.911</td>
<td style="text-align: right;">0.106</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.118</td>
<td style="text-align: right;">-0.085</td>
<td style="text-align: right;">0.134</td>
</tr>
<tr class="even">
<td style="text-align: left;">THA</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">0.551</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.219</td>
<td style="text-align: right;">-1.728</td>
<td style="text-align: right;">0.453</td>
<td style="text-align: right;">-0.133</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.106</td>
<td style="text-align: right;">0.161</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">-0.122</td>
<td style="text-align: right;">0.096</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TC</td>
<td style="text-align: left;">bp_MRTM2</td>
<td style="text-align: right;">1.107</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.085</td>
<td style="text-align: right;">-0.210</td>
<td style="text-align: right;">-0.883</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">-0.499</td>
<td style="text-align: right;">0.744</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">0.240</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">-0.046</td>
<td style="text-align: right;">0.110</td>
</tr>
<tr class="even">
<td style="text-align: left;">STR</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.306</td>
<td style="text-align: right;">0.159</td>
<td style="text-align: right;">0.122</td>
<td style="text-align: right;">0.239</td>
<td style="text-align: right;">-1.455</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">0.920</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.263</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">-0.053</td>
<td style="text-align: right;">0.101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FC</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.513</td>
<td style="text-align: right;">0.132</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">-0.284</td>
<td style="text-align: right;">-0.608</td>
<td style="text-align: right;">0.345</td>
<td style="text-align: right;">-0.386</td>
<td style="text-align: right;">0.820</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.299</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">-0.019</td>
<td style="text-align: right;">0.108</td>
</tr>
<tr class="even">
<td style="text-align: left;">WB</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.065</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.088</td>
<td style="text-align: right;">-0.390</td>
<td style="text-align: right;">-0.559</td>
<td style="text-align: right;">0.339</td>
<td style="text-align: right;">-0.392</td>
<td style="text-align: right;">0.818</td>
<td style="text-align: right;">0.073</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">-0.019</td>
<td style="text-align: right;">0.113</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WM</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">0.394</td>
<td style="text-align: right;">0.182</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">-0.279</td>
<td style="text-align: right;">-1.344</td>
<td style="text-align: right;">0.430</td>
<td style="text-align: right;">-0.294</td>
<td style="text-align: right;">0.850</td>
<td style="text-align: right;">0.354</td>
<td style="text-align: right;">0.387</td>
<td style="text-align: right;">0.425</td>
<td style="text-align: right;">-0.044</td>
<td style="text-align: right;">0.602</td>
</tr>
<tr class="even">
<td style="text-align: left;">GM</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.227</td>
<td style="text-align: right;">0.098</td>
<td style="text-align: right;">0.080</td>
<td style="text-align: right;">-0.268</td>
<td style="text-align: right;">-0.831</td>
<td style="text-align: right;">0.373</td>
<td style="text-align: right;">-0.357</td>
<td style="text-align: right;">0.830</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.217</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.097</td>
</tr>
<tr class="odd">
<td style="text-align: left;">OC</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.595</td>
<td style="text-align: right;">0.171</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.414</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.666</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.921</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.281</td>
<td style="text-align: right;">0.059</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.094</td>
</tr>
<tr class="even">
<td style="text-align: left;">insula</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.484</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">-0.493</td>
<td style="text-align: right;">-0.543</td>
<td style="text-align: right;">0.439</td>
<td style="text-align: right;">-0.267</td>
<td style="text-align: right;">0.852</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">0.253</td>
<td style="text-align: right;">0.057</td>
<td style="text-align: right;">-0.035</td>
<td style="text-align: right;">0.090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Putamen</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.437</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">-0.106</td>
<td style="text-align: right;">-1.321</td>
<td style="text-align: right;">0.457</td>
<td style="text-align: right;">-0.227</td>
<td style="text-align: right;">0.857</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.286</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">-0.044</td>
<td style="text-align: right;">0.103</td>
</tr>
<tr class="even">
<td style="text-align: left;">Caudate</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">0.876</td>
<td style="text-align: right;">0.149</td>
<td style="text-align: right;">0.170</td>
<td style="text-align: right;">0.093</td>
<td style="text-align: right;">-1.486</td>
<td style="text-align: right;">0.598</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.113</td>
<td style="text-align: right;">0.274</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">-0.088</td>
<td style="text-align: right;">0.148</td>
</tr>
<tr class="odd">
<td style="text-align: left;">THA</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">0.611</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">0.632</td>
<td style="text-align: right;">-0.916</td>
<td style="text-align: right;">0.294</td>
<td style="text-align: right;">-0.182</td>
<td style="text-align: right;">0.765</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">0.214</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">-0.125</td>
<td style="text-align: right;">0.125</td>
</tr>
<tr class="even">
<td style="text-align: left;">TC</td>
<td style="text-align: left;">bp_srtm</td>
<td style="text-align: right;">1.215</td>
<td style="text-align: right;">0.108</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.410</td>
<td style="text-align: right;">-0.437</td>
<td style="text-align: right;">0.414</td>
<td style="text-align: right;">-0.312</td>
<td style="text-align: right;">0.845</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.232</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">-0.006</td>
<td style="text-align: right;">0.109</td>
</tr>
<tr class="odd">
<td style="text-align: left;">STR</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.317</td>
<td style="text-align: right;">0.152</td>
<td style="text-align: right;">0.115</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">-1.494</td>
<td style="text-align: right;">0.656</td>
<td style="text-align: right;">0.063</td>
<td style="text-align: right;">0.917</td>
<td style="text-align: right;">0.070</td>
<td style="text-align: right;">0.255</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">-0.053</td>
<td style="text-align: right;">0.096</td>
</tr>
<tr class="even">
<td style="text-align: left;">FC</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.462</td>
<td style="text-align: right;">0.127</td>
<td style="text-align: right;">0.087</td>
<td style="text-align: right;">-0.203</td>
<td style="text-align: right;">-0.579</td>
<td style="text-align: right;">0.334</td>
<td style="text-align: right;">-0.397</td>
<td style="text-align: right;">0.816</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.291</td>
<td style="text-align: right;">0.074</td>
<td style="text-align: right;">-0.023</td>
<td style="text-align: right;">0.108</td>
</tr>
<tr class="odd">
<td style="text-align: left;">WB</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">0.995</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: right;">-0.443</td>
<td style="text-align: right;">0.392</td>
<td style="text-align: right;">-0.336</td>
<td style="text-align: right;">0.837</td>
<td style="text-align: right;">0.072</td>
<td style="text-align: right;">0.199</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">-0.034</td>
<td style="text-align: right;">0.108</td>
</tr>
<tr class="even">
<td style="text-align: left;">WM</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">0.230</td>
<td style="text-align: right;">0.137</td>
<td style="text-align: right;">0.597</td>
<td style="text-align: right;">0.102</td>
<td style="text-align: right;">-1.039</td>
<td style="text-align: right;">0.631</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.912</td>
<td style="text-align: right;">0.370</td>
<td style="text-align: right;">0.236</td>
<td style="text-align: right;">0.518</td>
<td style="text-align: right;">-0.157</td>
<td style="text-align: right;">0.712</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GM</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.151</td>
<td style="text-align: right;">0.094</td>
<td style="text-align: right;">0.082</td>
<td style="text-align: right;">0.136</td>
<td style="text-align: right;">-0.557</td>
<td style="text-align: right;">0.382</td>
<td style="text-align: right;">-0.347</td>
<td style="text-align: right;">0.833</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">0.207</td>
<td style="text-align: right;">0.058</td>
<td style="text-align: right;">-0.027</td>
<td style="text-align: right;">0.096</td>
</tr>
<tr class="even">
<td style="text-align: left;">OC</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.450</td>
<td style="text-align: right;">0.117</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">-0.549</td>
<td style="text-align: right;">-0.787</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">-0.054</td>
<td style="text-align: right;">0.905</td>
<td style="text-align: right;">0.052</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">0.048</td>
<td style="text-align: right;">-0.022</td>
<td style="text-align: right;">0.078</td>
</tr>
<tr class="odd">
<td style="text-align: left;">insula</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.424</td>
<td style="text-align: right;">0.116</td>
<td style="text-align: right;">0.081</td>
<td style="text-align: right;">-0.360</td>
<td style="text-align: right;">-0.597</td>
<td style="text-align: right;">0.410</td>
<td style="text-align: right;">-0.270</td>
<td style="text-align: right;">0.840</td>
<td style="text-align: right;">0.064</td>
<td style="text-align: right;">0.252</td>
<td style="text-align: right;">0.062</td>
<td style="text-align: right;">-0.040</td>
<td style="text-align: right;">0.090</td>
</tr>
<tr class="even">
<td style="text-align: left;">Putamen</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.442</td>
<td style="text-align: right;">0.129</td>
<td style="text-align: right;">0.089</td>
<td style="text-align: right;">-0.180</td>
<td style="text-align: right;">-1.307</td>
<td style="text-align: right;">0.483</td>
<td style="text-align: right;">-0.172</td>
<td style="text-align: right;">0.864</td>
<td style="text-align: right;">0.066</td>
<td style="text-align: right;">0.264</td>
<td style="text-align: right;">0.067</td>
<td style="text-align: right;">-0.046</td>
<td style="text-align: right;">0.093</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Caudate</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">0.869</td>
<td style="text-align: right;">0.147</td>
<td style="text-align: right;">0.169</td>
<td style="text-align: right;">0.126</td>
<td style="text-align: right;">-1.507</td>
<td style="text-align: right;">0.640</td>
<td style="text-align: right;">0.037</td>
<td style="text-align: right;">0.913</td>
<td style="text-align: right;">0.105</td>
<td style="text-align: right;">0.254</td>
<td style="text-align: right;">0.120</td>
<td style="text-align: right;">-0.081</td>
<td style="text-align: right;">0.141</td>
</tr>
<tr class="even">
<td style="text-align: left;">THA</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">0.568</td>
<td style="text-align: right;">0.077</td>
<td style="text-align: right;">0.136</td>
<td style="text-align: right;">0.376</td>
<td style="text-align: right;">-1.435</td>
<td style="text-align: right;">0.375</td>
<td style="text-align: right;">-0.149</td>
<td style="text-align: right;">0.811</td>
<td style="text-align: right;">0.119</td>
<td style="text-align: right;">0.187</td>
<td style="text-align: right;">0.133</td>
<td style="text-align: right;">-0.130</td>
<td style="text-align: right;">0.114</td>
</tr>
<tr class="odd">
<td style="text-align: left;">TC</td>
<td style="text-align: left;">bp_refLogan</td>
<td style="text-align: right;">1.124</td>
<td style="text-align: right;">0.095</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">-0.521</td>
<td style="text-align: right;">-0.361</td>
<td style="text-align: right;">0.299</td>
<td style="text-align: right;">-0.431</td>
<td style="text-align: right;">0.802</td>
<td style="text-align: right;">0.071</td>
<td style="text-align: right;">0.222</td>
<td style="text-align: right;">0.065</td>
<td style="text-align: right;">-0.026</td>
<td style="text-align: right;">0.110</td>
</tr>
</tbody>
</table>

Interregional Correlation
=========================

Here the interregional correlations for BP values

``` r
bp_srtm <- tacs_long %>%
  select(PET, Region, bp_srtm) %>%
  spread(Region, bp_srtm)

bp_mrtm2 <- tacs_long %>%
  select(PET, Region, bp_MRTM2) %>%
  spread(Region, bp_MRTM2)

bp_logan <- tacs_long %>%
  select(PET, Region, bp_refLogan) %>%
  spread(Region, bp_refLogan)

col2 <- colorRampPalette(rev(c("#67001F", "#B2182B", "#D6604D", "#F4A582", "#FDDBC7",
                           "#FFFFFF", "#D1E5F0", "#92C5DE", "#4393C3", "#2166AC", "#053061")))

par(mfrow=c(2,2))

bp_srtm %>%
  select(FC:WM, - Putamen) %>%
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(bp_srtm ~ Correlations),
                 mar=c(0,0,1,0))

bp_logan %>%
  select(FC:WM, - Putamen) %>%
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(bp_logan ~ Correlations),
                 mar=c(0,0,1,0))

bp_mrtm2 %>%
  select(FC:WM, - Putamen) %>%
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(bp_MRTM2 ~ Correlations),
                 mar=c(0,0,1,0))
```

![](AZ10419369_files/figure-markdown_github/corrplots-1.png)

\#Corrplot between measures for a single region

``` r
compare <- tacs_long %>% 
  select(PET, Region, bp_srtm, bp_refLogan ,bp_MRTM2 ) %>% 
  filter(Region %in% c('FC', 'WB', 'insula', 'OC'))

par(mfrow=c(2,2))

compare %>%
  filter(Region == "FC") %>%
  select(bp_srtm:bp_MRTM2) %>% 
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(Model ~ Correlations ~ Region: FC),
                 mar=c(0,0,1,0)) 

compare %>%
  filter(Region == "OC") %>%
  select(bp_srtm:bp_MRTM2) %>% 
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(Model ~ Correlations ~ Region: OC),
                 mar=c(0,0,1,0))  

compare %>%
  filter(Region == "insula") %>%
  select(bp_srtm:bp_MRTM2) %>% 
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(Model ~ Correlations ~ Region: insula),
                 mar=c(0,0,1,0))  

compare %>%
  filter(Region == "WB") %>%
  select(bp_srtm:bp_MRTM2) %>% 
  cor() %>%
  corrplot.mixed(lower='ellipse', upper='number', 
                 lower.col = col2(200), upper.col = col2(200),  diag='n',
                 number.digits = 2, title=expression(Model ~ Correlations ~ Region: WB),
                 mar=c(0,0,1,0)) 
```

![](AZ10419369_files/figure-markdown_github/corrplot-1.png)

bp corellation
==============

R-squared
---------

``` r
trtdata <- tacs_long %>%
  select(PET, Subjname, PETNo, Region, bp_refLogan, bp_srtm, bp_MRTM2) %>%
  gather(Measure, Value, -(PET:Region)) %>%
  spread(Region, Value)

trtdata <- trtdata %>%
  select( -(c(Caudate, Putamen, insula))) %>%
  gather(Region, Value, -(PET:Measure)) %>%
  unite(Outcome, Measure, Region) %>%
  spread(Outcome, Value)

corout <- trtdata %>%
  gather(Measure, Binding, -(PET:PETNo), -bp_srtm_WB) %>%
  group_by(Measure) %>%
  summarise('R^2^'=cor(Binding, bp_srtm_WB)^2) %>%
  arrange(Measure) %>%
  ungroup() %>%
  mutate(Measure = str_replace(string=Measure, pattern='_', replacement='~')) %>%
  mutate(Measure = str_replace(string=Measure, pattern='FC', replacement='FC~')) %>%
  mutate(Measure = str_replace(string=Measure, pattern='WB', replacement='WB~')) %>%
  mutate(Measure = str_replace(string=Measure, pattern='OC', replacement='OC~')) %>% 
  mutate(Measure = str_replace(string=Measure, pattern='WM', replacement='WM~')) %>% 
  mutate(Measure = str_replace(string=Measure, pattern='GM', replacement='GM~')) %>% 
  mutate(Measure = str_replace(string=Measure, pattern='STR', replacement='STR~')) 

kable(corout, digits=2, caption="Correlations with BP_srtm~WB~", format = 'markdown')
```

| Measure                    |  R<sup>2</sup>|
|:---------------------------|--------------:|
| bp<sub>MRTM2\_FC</sub>     |           0.70|
| bp<sub>MRTM2\_GM</sub>     |           0.77|
| bp<sub>MRTM2\_OC</sub>     |           0.75|
| bp<sub>MRTM2\_STR</sub>    |           0.54|
| bp\~MRTM2\_TC              |           0.90|
| bp\~MRTM2\_THA             |           0.17|
| bp<sub>MRTM2\_WB</sub>     |           0.86|
| bp<sub>MRTM2\_WM</sub>     |           0.43|
| bp<sub>refLogan\_FC</sub>  |           0.74|
| bp<sub>refLogan\_GM</sub>  |           0.84|
| bp<sub>refLogan\_OC</sub>  |           0.77|
| bp<sub>refLogan\_STR</sub> |           0.52|
| bp\~refLogan\_TC           |           0.92|
| bp\~refLogan\_THA          |           0.13|
| bp<sub>refLogan\_WB</sub>  |           0.91|
| bp<sub>refLogan\_WM</sub>  |           0.39|
| bp<sub>srtm\_FC</sub>      |           0.76|
| bp<sub>srtm\_GM</sub>      |           0.93|
| bp<sub>srtm\_OC</sub>      |           0.59|
| bp<sub>srtm\_STR</sub>     |           0.54|
| bp\~srtm\_TC               |           0.86|
| bp\~srtm\_THA              |           0.08|
| bp<sub>srtm\_WM</sub>      |           0.23|

\#Plot of the change between PETNo = 1 and PETNo = 2. error bars for the
wscv probably mean nothing as there is just a single value, but looks
nice?

``` r
trtdata <- trtdata %>% 
  gather(Region, Value, -(PET:PETNo)) %>% 
  separate(col = "Region", into = c("outcome","Measure", "Region"), sep = '_') %>% 
  unite(outcome, outcome, Measure, sep = '_') %>% 
  ungroup()

trtsrtm <- trtdata %>% 
  filter(outcome == 'bp_srtm')

ggplot(trtsrtm, aes(x = PETNo, y = Value, 
                         group = Region, colour=Region)) +
  geom_point() +
  geom_smooth(method = 'lm', se = FALSE) +
  facet_wrap( ~ Subjname, ncol = 4)
```

![](AZ10419369_files/figure-markdown_github/unnamed-chunk-3-1.png)

``` r
#same as above, just made into a variable for plot.grid

q <- ggplot(trtsrtm, aes(x = PETNo, y = Value, 
                         group = Region, colour=Region)) +
  geom_point() +
  geom_smooth(method = 'lm', se = FALSE) +
  facet_wrap( ~ Subjname, ncol = 4)

#plot wscv by model

ggplot(trt_table, aes(y = wscv, x = Measure, colour = Region ))+
  geom_point()+
  geom_errorbar(aes(ymin=wscv, ymax=wscv)) +
  facet_grid(Measure~.) + coord_flip()
```

![](AZ10419369_files/figure-markdown_github/unnamed-chunk-3-2.png)

``` r
srtm_trt_table <-  trt_table %>% 
  filter(Measure == "bp_srtm") %>% 
  rename(bp_srtm = Measure)  
  

p <- ggplot(srtm_trt_table, aes(y = wscv, x = bp_srtm, colour = Region ))+
  geom_point()+
  geom_errorbar(aes(ymin=wscv, ymax=wscv))+
  coord_flip()

#plot_grid of change between PETNo 1 and 2 (plot q) and wscv.
#note: Regions coloured differently. This is what I try to do with ggdraw() below, I just want the wscv plot in the top right corner as a smaller version of itself

plot_grid(q,p, rel_widths = c(1.5,1), rel_heights = c(1.5,1))
```

![](AZ10419369_files/figure-markdown_github/unnamed-chunk-3-3.png)

\#\#draw\_plot-related failures. attempt to create a subplot in the top
right corner as shown in the cowplot tutorial

``` r
q <- ggplot(trtsrtm, aes(x = PETNo, y = Value, 
                         group = Region, colour=Region)) +
  geom_point() +
  geom_smooth(method = 'lm', se = FALSE) +
  facet_wrap( ~ Subjname, ncol = 4)

p <- ggplot(srtm_trt_table, aes(y = wscv, x = bp_srtm, colour = region ))+
  geom_point()+
  geom_errorbar(aes(ymin=wscv, ymax=wscv))+
  coord_flip()


ggdraw() +
  draw_plot(q + theme(legend.justification = "bottom"), 0, 0, 1, 1 + 
              scale_color_viridis(discrete = TRUE)) +
  draw_plot(p + scale_color_viridis(discrete = TRUE) + 
              theme(legend.justification = "top"), .6, .6, .4, .4) +
  draw_plot_label(c("A", "B"), c(0, 0.5), c(1, 0.92), size = 15)
```

\#all estimates in all models using facet\_grid.

Idea: scale the estimates to the same scale and have them all in the
same facet as the Y- axis and remove the current faceting by estimate on
the x-axis

``` r
Srtm_trt_table <-  trt_table %>% 
  gather(estimate, Value, -(Region:Measure))


#This one needs work

ggplot(Srtm_trt_table, aes(y = Region, x = Value, colour = Region ))+
  geom_point()+
  facet_grid(  Measure ~ estimate) 
```

![](AZ10419369_files/figure-markdown_github/unnamed-chunk-5-1.png)
